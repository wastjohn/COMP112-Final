---
title: "main"
author: "WillStJohn"
date: "2022-11-04"
output: html_document
---


```{r, include=FALSE, echo=FALSE}
library(readr)
library(ggplot2)
library(tidyverse)
library(ggpubr)
majors <- read_csv("https://raw.githubusercontent.com/wastjohn/COMP112-Final/main/majordata.csv")
fgen <- majors %>% filter(is.na(first_gen) == FALSE)
```


# First Generation Macalester College Majors

### What do we mean by "First Generation?" *A note about the data*

First generation college students are students who are the first in their family to attend college. In terms of this research, first generation students are those who identify as "first gen" on Macalester forms utilized by Macalester's Institutional Research office. *The Institutional Research office provided us with the data set used in this research.*

Now that we know where the data is coming from, let's clarify what it means to be a first gen student as it relates to the data.

The Mac major data contains around 2500 units of observation, with a little more than 60 variables for each observation. The units of observation themselves are individual students that graduated from Macalester College between the Fall of 2013 and the Spring of 2018. The variables themselves contain information such as graduation year, sex, major(s), whether or not they are a first generation student, and whether or not they studied away.

Our primary focus of this research was with students who identified as "first gen" compared to the entire data.

### What do first gen students look like?

How does the subsection of first gen students compare with the rest of the data?

Surprisingly, most of the data has no information about whether or not a student is a first generational student or not. With what information is available, there are fewer first gen students than students who are not first gen.

```{r, echo=FALSE}
#How many first gen students are in the dataset?
ggplot(majors, aes(x=first_gen)) +
  geom_bar()
```

#### Graduation Year

```{r, echo=FALSE}
#When do first gen's graduate?
fgen_year_plot <- ggplot(fgen, aes(x = grad_year)) +
  geom_bar() +
  labs(title = 'First Generation Graduations Per Year', x = '', y = '')

year_plot <- ggplot(majors, aes(x = grad_year, fill = grad_year)) +
  geom_bar() + 
  labs(title = 'All Macalester Graduations Per Year', x = '', y = '')

year_fig <- ggarrange(fgen_year_plot, year_plot, ncol = 2)
annotate_figure(year_fig, 
                top = '', 
                bottom = 'Graduation Year', 
                left = 'Count', 
                right = '')
```
The first thing to notice about first gen students is that they don't make up a large portion of the student body in any given year. The only data available on the first gen status of students is from the 2016-2017 and the 2017-2018 classes, and even those data aren't fully complete. From the data available, it appears that about 10% of any given class is made up of first gen students, though the true rate could vary due to the amount of students whose status is unavailable.


## Classification Tree
```{r, echo=FALSE}
library(rpart)
library(rpart.plot)

head(majors)


first_gen_major <- majors %>% 
  drop_na(first_gen)
  
shuffle_index <- sample(1:nrow(first_gen_major))

first_gen_major <- first_gen_major[shuffle_index, ]

clean_first_gen <- first_gen_major %>%
  select(c(first_gen, sex, tot_enroll_ct, prefix_count, major1_division))

create_train_test <- function(data, size = 0.8, train = TRUE) {
    n_row = nrow(data)
    total_row = size * n_row
    train_sample <- 1:total_row
    if (train == TRUE) {
        return (data[train_sample, ])
    } else {
        return (data[-train_sample, ])
    }
}

data_train <- create_train_test(clean_first_gen, 0.8, train = TRUE)

data_test <- create_train_test(clean_first_gen, 0.8, train = FALSE)

fit <- rpart(sex~., data = data_train, method = "class")

rpart.plot(fit, extra = 106)
```



#interesting general information about first gens that could help with future questions 
summary(f_gen) #no first gen students majored in geology, theater and dance, spanish/portuguese, etc



## The Data

-   Provided by Macalester's Institutional Research office
-   Data regarding previous graduated students from Fall 2013 to Spring 2018
-   Approximately 2500 total students

## The Sample {.smaller}



```{r, echo=FALSE}
ggplot(majors, aes(x=first_gen, fill = sex)) + #add fill = sex maybe?
  geom_bar() +
  facet_grid(~grad_year) +
  scale_fill_viridis_d() +
  labs(title = 'First Gen Distribution by Sex from Fall 2013 to Spring 2018', x = 'Type of Student', y = 'Count')
  
```

-   Approximately 120 first gen graduates
-   Not a lot of first gen data till 2016
-   Very specific sample
-   Drop the NA (need to do this)

## The Sample: Limited

```{r}
ggplot(fgen, aes(x=first_gen, fill = sex)) +
  geom_bar() + #add position = fill for a prop bar chart
  facet_grid(~grad_year) +
  scale_fill_viridis_d() +
  labs(title = 'First Gen Distribution by Sex from Fall 2015 to Spring 2018', x = 'Type of Student', y = 'Count')
```

-   Overall More Females than Males

## First Gen Majors: Major 1

```{r}
ggplot(fgen %>% filter(major_ct == 1), aes(x = major_ct, fill = major1_division)) +
  geom_bar(position = 'fill') +
  facet_grid(~first_gen)+
  scale_fill_viridis_d() +
  labs(title = 'Proportion of First Major Division', x = 'Number of Majors', y = 'Percent') +
  scale_x_discrete(limits = 1)
```
## First Gen Majors: Major 2

```{r}
ggplot(fgen %>% filter(major_ct == 2), aes(x = major_ct, fill = major2_division)) +
  geom_bar(position = 'fill') +
  facet_grid(~first_gen)+
  scale_fill_viridis_d() +
  labs(title = 'Proportion of Second Major Division', x = 'Number of Majors', y = 'Percent') +
  scale_x_discrete(limits = 2)
```
## First Gen Majors: Major 3

```{r}
ggplot(fgen %>% filter(major_ct == 3), aes(x = major_ct, fill = major3_division)) +
  geom_bar(position = 'fill') +
  facet_grid(~first_gen)+
  scale_fill_viridis_d() +
  labs(title = 'Proportion of Third Major Division', x = 'Number of Majors', y = 'Percent') +
  scale_x_discrete(limits = 3)
```

## First Major: Fine Arts

```{r}
ggplot(fgen %>% filter(major1_division == 'Fine Arts'), aes(x = first_gen, fill = major1)) +
  geom_bar(position = 'Fill') +
  scale_fill_viridis_d() +
  labs(title = 'Fine Arts Major Distribution') +
  facet_wrap(~sex) +
  labs(title = 'Proportion of Students with Fine Arts First Major', x = 'Type of Student', y = 'Percent')
```

## First Major: Humanities

```{r}
ggplot(fgen %>% filter(major1_division == 'Humanities'), aes(x = first_gen, fill = major1)) +
  geom_bar(position = 'Fill') +
  scale_fill_viridis_d() +
  labs(title = 'Humanities Major Distribution') +
  facet_wrap(~sex) +
  labs(title = 'Proportion of Students with Humanities First Major', x = 'Type of Student', y = 'Percent')

```

## First Major: Interdisciplinary

```{r}
ggplot(fgen %>% filter(major1_division == 'Interdisciplinary'), aes(x = first_gen, fill = major1)) +
  geom_bar(position = 'Fill') +
  scale_fill_viridis_d() +
  labs(title = 'Interdisciplinary Major Distribution')+ 
  facet_wrap(~sex) +
  labs(title = 'Proportion of Students with Interdisciplinary First Major', x = 'Type of Student', y = 'Percent')

```

## First Major: Natural Sciences and Mathematics

```{r}
ggplot(fgen %>% filter(major1_division == 'Natural Sciences and Mathematics'), aes(x = first_gen, fill = major1)) +
  geom_bar(position = 'Fill') +
  scale_fill_viridis_d() +
  labs(title = 'Natural Sciences and Mathematics Major Distribution') +
  facet_wrap(~sex) +
  labs(title = 'Proportion of Students with Natural Sciences and Mathematics First Major', x = 'Type of Student', y = 'Percent')
```

## First Major: Social Sciences

```{r}
ggplot(fgen %>% filter(major1_division == 'Social Sciences'), aes(x = first_gen, fill = major1)) +
  geom_bar(position = 'fill') +
  scale_fill_viridis_d() +
  labs(title = 'Social Sciences Major Distribution')+
  facet_wrap(~sex) +
  labs(title = 'Proportion of Students with Social Sciences First Major', x = 'Type of Student', y = 'Percent')
```

## Second Major: Fine Arts

```{r}
ggplot(fgen %>% filter(major2_division == 'Fine Arts'), aes(x = first_gen, fill = major2)) +
  geom_bar(position = 'Fill') +
  scale_fill_viridis_d() +
  labs(title = 'Fine Arts Major Distribution') +
  facet_wrap(~sex) +
  labs(title = 'Proportion of Students with Fine Arts Second Major', x = 'Type of Student', y = 'Percent')
```

## Second Major: Humanities

```{r}
ggplot(fgen %>% filter(major2_division == 'Humanities'), aes(x = first_gen, fill = major2)) +
  geom_bar(position = 'Fill') +
  scale_fill_viridis_d() +
  labs(title = 'Humanities Major Distribution') +
  facet_wrap(~sex) +
  labs(title = 'Proportion of Students with Humanities Second Major', x = 'Type of Student', y = 'Percent')
```

## Second Major: Interdisciplinary

```{r}
ggplot(fgen %>% filter(major2_division == 'Interdisciplinary'), aes(x = first_gen, fill = major2)) +
  geom_bar(position = 'Fill') +
  scale_fill_viridis_d()+
  labs(title = 'Interdisciplinary Major Distribution') +
  facet_wrap(~sex) +
  labs(title = 'Proportion of Students with Interdisciplinary Second Major', x = 'Type of Student', y = 'Percent')
```

## Second Major: Natural Sciences and Mathematics

```{r}
ggplot(fgen %>% filter(major2_division == 'Natural Sciences and Mathematics'), aes(x = first_gen, fill = major2)) +
  geom_bar(position = 'Fill') +
  scale_fill_viridis_d() +
  labs(title = 'Natural Science and Mathematics Major Distribution') +
  facet_wrap(~sex) +
  labs(title = 'Proportion of Students with Natural Sciences and Mathematics Second Major', x = 'Type of Student', y = 'Percent')
```

## Second Major: Social Sciences

```{r}

ggplot(fgen %>% filter(major2_division == 'Social Sciences'), aes(x = first_gen, fill = major2)) +
  geom_bar(position = 'fill') +
  scale_fill_viridis_d() +
  labs(title = 'Social Sciences Major Distribution') +
  facet_wrap(~sex) +
  labs(title = 'Proportion of Students with Social Sciences Second Major', x = 'Type of Student', y = 'Percent')
```

## Studied Away By Sex

```{r}
ggplot(fgen, aes(x = studied_away, fill = sex)) +
  geom_bar(position = 'Fill') +
  facet_grid(~first_gen) +
  scale_fill_viridis_d() +
  labs(title = 'Proportion of Students Who Studied Abroad', x = 'Stayed Home or Studied Abroad', y = 'Percent') +
  scale_x_discrete(limits = c(0, 1), labels = c('Home', 'Abroad'))
```

## Conclusions
-   Fewer first gen students overall
-   First Gen records begin later
-   More females than males

## Limitations/Assumptions
-   Small sample size
-   





